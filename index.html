<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ½ï¸ DashControl Restaurante Premium</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:'Poppins',sans-serif; background:#0d0d0d; color:white; }
    header { background:linear-gradient(90deg,#8e44ad,#b8860b); padding:15px; font-size:22px; font-weight:700; text-align:center; }
    nav { display:flex; justify-content:center; flex-wrap:wrap; background:#1e1e1e; }
    nav button { background:#8e44ad; border:none; margin:5px; padding:10px 15px; border-radius:8px; color:white; font-weight:bold; cursor:pointer; }
    nav button:hover { background:#b8860b; }
    section { display:none; padding:20px; max-width:1000px; margin:auto; }
    h2 { color:#d4af37; margin:15px 0; }
    input, select { padding:10px; border:none; border-radius:6px; width:100%; margin:5px 0; background:#2c2c2c; color:white; }
    .btn { background:#8e44ad; padding:10px; margin:5px; border-radius:6px; cursor:pointer; border:none; color:white; font-weight:bold; }
    .btn:hover { background:#b8860b; }
    .list { background:#1a1a1a; border-radius:8px; padding:10px; margin-top:10px; }
    .list div { padding:6px 0; border-bottom:1px solid #333; }
    .chart-card { background:#1a1a1a; border-radius:12px; padding:15px; margin:20px auto; box-shadow:0 4px 20px rgba(0,0,0,0.6); max-width:1200px; }
    .chart { width:100%; height:400px; }
    .prod-btn { font-size:22px; padding:15px; margin:10px; border:none; border-radius:10px; background:#2c2c2c; color:white; cursor:pointer; width:120px; height:120px; display:flex; flex-direction:column; align-items:center; justify-content:center; }
    .prod-btn:hover { background:#8e44ad; transform:scale(1.05); }
    .pay-btn { font-size:20px; padding:20px; margin:10px; border:none; border-radius:10px; background:#2c2c2c; color:white; cursor:pointer; width:150px; }
    .pay-btn:hover { background:#27ae60; transform:scale(1.05); }
    .kpi { background:#1a1a1a; display:inline-block; padding:15px; border-radius:10px; margin:10px; min-width:150px; font-size:14px; }
  </style>
</head>
<body>
<header>ğŸ½ï¸ DashControl Restaurante Premium</header>
<nav>
  <button onclick="showTab('garcom')">ğŸ§‘ GarÃ§om</button>
  <button onclick="showTab('caixa')">ğŸ’µ Caixa</button>
  <button onclick="showTab('admin')">âš™ï¸ Admin</button>
  <button onclick="showTab('dashboard')">ğŸ“Š Dashboard</button>
</nav>

<!-- ğŸ§‘ GarÃ§om -->
<section id="garcom">
  <h2>ğŸ§‘ Ãrea do GarÃ§om</h2>
  <select id="garcomNome"></select>
  <input type="number" id="mesaNumero" placeholder="NÃºmero da Mesa">
  <div id="produtosBtns" style="display:flex;flex-wrap:wrap;"></div>
  <div class="list" id="listaMesas"></div>
</section>

<!-- ğŸ’µ Caixa -->
<section id="caixa">
  <h2>ğŸ’µ Caixa</h2>
  <div class="list" id="mesasAbertas"></div>
</section>

<!-- âš™ï¸ Admin -->
<section id="admin">
  <h2>âš™ï¸ AdministraÃ§Ã£o</h2>
  <h3>ğŸ“¦ Estoque</h3>
  <input type="text" id="estNome" placeholder="Nome do Produto">
  <input type="text" id="estIcone" placeholder="Ãcone/Emoji (ğŸ•, ğŸº)">
  <input type="number" id="estValor" placeholder="Valor (R$)">
  <input type="number" id="estQtd" placeholder="Quantidade">
  <button class="btn" onclick="addEstoque()">â• Adicionar Produto</button>
  <div class="list" id="listaEstoque"></div>

  <h3>ğŸ§‘ Gerenciar GarÃ§ons</h3>
  <input type="text" id="novoGarcom" placeholder="Nome do GarÃ§om">
  <button class="btn" onclick="addGarcom()">â• Adicionar GarÃ§om</button>
  <div class="list" id="listaGarcons"></div>
</section>

<!-- ğŸ“Š Dashboard -->
<section id="dashboard">
  <h2>ğŸ“Š Dashboard</h2>
  <div class="kpi">Receita Total: R$ <span id="kpiReceita">0</span></div>
  <div class="kpi">Saldo: R$ <span id="kpiSaldo">0</span></div>
  <div class="kpi">Produtos em Estoque: <span id="kpiEstoque">0</span></div>
  <div class="chart-card"><div id="chartVendas" class="chart"></div></div>
  <div class="chart-card"><div id="chartGarcons" class="chart"></div></div>
  <div class="chart-card"><div id="chartPagamentos" class="chart"></div></div>
  <div class="chart-card"><div id="chartLinha" class="chart"></div></div>
  <div class="chart-card"><div id="chartEstoque" class="chart"></div></div>
</section>

<script>
let dados = JSON.parse(localStorage.getItem("restaurante")) || {garcons:["JoÃ£o","Maria"], mesas:[], estoque:[{nome:"Pizza",icone:"ğŸ•",valor:40,qtd:10},{nome:"Cerveja",icone:"ğŸº",valor:8,qtd:30},{nome:"Refrigerante",icone:"ğŸ¥¤",valor:6,qtd:20},{nome:"HambÃºrguer",icone:"ğŸ”",valor:25,qtd:15}], vendas:[], financeiro:{entradas:0,saidas:0,saldo:0}};

function save(){ localStorage.setItem("restaurante",JSON.stringify(dados)); }

// NavegaÃ§Ã£o
function showTab(tab){
  document.querySelectorAll("section").forEach(s=>s.style.display="none");
  document.getElementById(tab).style.display="block";
  if(tab==="garcom"){renderMesas();renderGarcomSelect();renderProdutosBtns();}
  if(tab==="caixa") renderCaixa();
  if(tab==="admin"){renderEstoque();renderGarcons();}
  if(tab==="dashboard") renderDashboard();
}

// ğŸ§‘ GarÃ§om
function abrirMesa(garcom,mesa){
  if(!garcom||!mesa){alert("Preencha garÃ§om e mesa!");return;}
  if(dados.mesas.find(m=>m.numero==mesa&&m.aberta)){alert("Mesa jÃ¡ aberta!");return;}
  dados.mesas.push({numero:mesa,garcom,pedidos:[],aberta:true});
  save();renderMesas();alert("âœ… Mesa aberta!");
}
function addPedido(idx){
  let garcom=document.getElementById("garcomNome").value;
  let mesa=document.getElementById("mesaNumero").value;
  if(!garcom||!mesa){alert("Preencha garÃ§om e mesa!");return;}
  let mesaObj=dados.mesas.find(m=>m.numero==mesa&&m.aberta);
  if(!mesaObj){abrirMesa(garcom,mesa); mesaObj=dados.mesas.find(m=>m.numero==mesa&&m.aberta);}
  let produto=dados.estoque[idx];
  if(produto.qtd<=0){alert("Estoque insuficiente!");return;}
  mesaObj.pedidos.push({produto:produto.nome,valor:produto.valor,qtd:1});
  produto.qtd--;
  save();renderMesas();alert("âœ… Pedido adicionado!");
}
function renderMesas(){
  let html=""; dados.mesas.filter(m=>m.aberta).forEach(m=>{
    html+=`<div>Mesa ${m.numero} - GarÃ§om: ${m.garcom}<br>Pedidos: ${m.pedidos.map(p=>`${p.qtd}x ${p.produto}`).join(", ")||"Nenhum"}</div>`;
  });
  document.getElementById("listaMesas").innerHTML=html||"<p>Sem mesas abertas.</p>";
}
function renderGarcomSelect(){
  let sel=document.getElementById("garcomNome"); sel.innerHTML="";
  dados.garcons.forEach(g=>{let opt=document.createElement("option"); opt.value=g; opt.textContent=g; sel.appendChild(opt);});
}
function renderProdutosBtns(){
  let div=document.getElementById("produtosBtns"); div.innerHTML="";
  dados.estoque.forEach((p,i)=>{div.innerHTML+=`<button class="prod-btn" onclick="addPedido(${i})">${p.icone||"ğŸ½ï¸"}<br>${p.nome}<br>R$${p.valor}</button>`;});
}

// ğŸ’µ Caixa
function renderCaixa(){
  let html=""; dados.mesas.filter(m=>m.aberta).forEach((m,i)=>{
    let total=m.pedidos.reduce((s,p)=>s+p.valor*p.qtd,0);
    html+=`<div><b>Mesa ${m.numero}</b> - GarÃ§om: ${m.garcom} - Total R$${total}<br>
      <button class="pay-btn" onclick="encerrarMesa(${i},'Pix')">âš¡ Pix</button>
      <button class="pay-btn" onclick="encerrarMesa(${i},'DÃ©bito')">ğŸ’³ DÃ©bito</button>
      <button class="pay-btn" onclick="encerrarMesa(${i},'CrÃ©dito')">ğŸ’³ CrÃ©dito</button>
      <button class="pay-btn" onclick="encerrarMesa(${i},'Dinheiro')">ğŸ’µ Dinheiro</button></div>`;
  });
  document.getElementById("mesasAbertas").innerHTML=html||"<p>Nenhuma mesa aberta.</p>";
}
function encerrarMesa(idx,pagamento){
  let mesa=dados.mesas[idx];
  let total=mesa.pedidos.reduce((s,p)=>s+p.valor*p.qtd,0);
  dados.vendas.push({mesa:mesa.numero,garcom:mesa.garcom,total,pagamento,data:new Date().toLocaleDateString()});
  dados.financeiro.entradas+=total; dados.financeiro.saldo+=total;
  mesa.aberta=false;
  save();renderCaixa();alert("âœ… Mesa encerrada!");
}

// âš™ï¸ Admin
function addEstoque(){
  let nome=document.getElementById("estNome").value;
  let icone=document.getElementById("estIcone").value;
  let valor=parseFloat(document.getElementById("estValor").value)||0;
  let qtd=parseInt(document.getElementById("estQtd").value)||0;
  if(!nome||valor<=0){alert("Preencha todos os campos!");return;}
  dados.estoque.push({nome,icone,valor,qtd});
  save();renderEstoque();alert("âœ… Produto adicionado!");
}
function renderEstoque(){
  let html=""; dados.estoque.forEach(e=>{html+=`<div>${e.icone||"ğŸ½ï¸"} ${e.nome} - R$${e.valor} | Qtd:${e.qtd}</div>`;});
  document.getElementById("listaEstoque").innerHTML=html||"<p>Sem produtos.</p>";
  renderProdutosBtns();
}
function addGarcom(){
  let nome=document.getElementById("novoGarcom").value;
  if(!nome){alert("Digite o nome do garÃ§om!");return;}
  dados.garcons.push(nome);
  save();renderGarcons();alert("âœ… GarÃ§om adicionado!");
}
function renderGarcons(){
  let html=""; dados.garcons.forEach(g=>{html+=`<div>${g}</div>`;});
  document.getElementById("listaGarcons").innerHTML=html||"<p>Nenhum garÃ§om.</p>";
}

// ğŸ“Š Dashboard
function renderDashboard(){
  document.getElementById("kpiReceita").innerText=dados.financeiro.entradas;
  document.getElementById("kpiSaldo").innerText=dados.financeiro.saldo;
  document.getElementById("kpiEstoque").innerText=dados.estoque.reduce((s,p)=>s+p.qtd,0);

  // Vendas por Produto
  let porProd={}; dados.vendas.forEach(v=>{porProd[v.mesa]=(porProd[v.mesa]||0)+v.total;});
  echarts.init(document.getElementById("chartVendas")).setOption({
    title:{text:"Vendas por Mesa",textStyle:{color:"#d4af37"}},
    xAxis:{type:"category",data:Object.keys(porProd),axisLabel:{color:"#fff"}},
    yAxis:{type:"value",axisLabel:{color:"#fff"}},
    series:[{type:"bar",data:Object.values(porProd),label:{show:true,color:"#fff"}}]
  });

  // Vendas por GarÃ§om
  let porGarcom={}; dados.vendas.forEach(v=>{porGarcom[v.garcom]=(porGarcom[v.garcom]||0)+v.total;});
  echarts.init(document.getElementById("chartGarcons")).setOption({
    title:{text:"Vendas por GarÃ§om",textStyle:{color:"#d4af37"}},
    xAxis:{type:"category",data:Object.keys(porGarcom),axisLabel:{color:"#fff"}},
    yAxis:{type:"value",axisLabel:{color:"#fff"}},
    series:[{type:"bar",data:Object.values(porGarcom),label:{show:true,color:"#fff"}}]
  });

  // Formas de Pagamento
  let formas={}; dados.vendas.forEach(v=>{formas[v.pagamento]=(formas[v.pagamento]||0)+v.total;});
  echarts.init(document.getElementById("chartPagamentos")).setOption({
    title:{text:"Formas de Pagamento",textStyle:{color:"#d4af37"}},
    series:[{type:"pie",radius:["40%","70%"],data:Object.entries(formas).map(([k,v])=>({name:k,value:v})),label:{show:true,color:"#fff"}}]
  });

  // Receita no Tempo
  let porData={}; dados.vendas.forEach(v=>{porData[v.data]=(porData[v.data]||0)+v.total;});
  echarts.init(document.getElementById("chartLinha")).setOption({
    title:{text:"Receita no Tempo",textStyle:{color:"#d4af37"}},
    xAxis:{type:"category",data:Object.keys(porData),axisLabel:{color:"#fff"}},
    yAxis:{type:"value",axisLabel:{color:"#fff"}},
    series:[{type:"line",data:Object.values(porData),smooth:true,areaStyle:{color:"rgba(212,175,55,0.3)"},label:{show:true,color:"#fff"}}]
  });

  // Estoque Atual
  echarts.init(document.getElementById("chartEstoque")).setOption({
    title:{text:"Estoque Atual",textStyle:{color:"#d4af37"}},
    xAxis:{type:"category",data:dados.estoque.map(p=>p.nome),axisLabel:{color:"#fff"}},
    yAxis:{type:"value",axisLabel:{color:"#fff"}},
    series:[{type:"bar",data:dados.estoque.map(p=>p.qtd),label:{show:true,color:"#fff"}}]
  });
}

// InicializaÃ§Ã£o
showTab("garcom");
</script>
</body>
</html>